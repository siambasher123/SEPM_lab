<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>School System</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body class="bg-light">

<div class="container py-5">
  <!-- LOGIN FORM -->
  <div th:if="${page == 'login'}" class="row justify-content-center align-items-center min-vh-100">
    <div class="col-md-5 col-lg-4">
      <div class="card border-0 shadow-lg overflow-hidden" style="border-radius: 20px;">
        <!-- Decorative Top Bar -->
        <div class="card-header bg-gradient-primary text-white p-4 border-0" style="border-radius: 20px 20px 0 0;">
          <div class="d-flex align-items-center">
            <div class="logo-circle me-3" style="width: 50px; height: 50px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
              <i class="bi bi-mortarboard-fill fs-4"></i>
            </div>
            <div>
              <h4 class="mb-0 fw-bold">School System</h4>
              <small class="opacity-75">Welcome back!</small>
            </div>
          </div>
        </div>

        <div class="card-body p-4">
          <!-- Animated Illustration -->
          <div class="text-center mb-4">
            <div class="login-illustration mx-auto mb-3" style="width: 120px; height: 120px; background: linear-gradient(135deg, #667eea 0%, #764ba2 50%); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
              <i class="bi bi-person-badge text-white" style="font-size: 3.5rem;"></i>
            </div>
            <h3 class="fw-bold text-dark mb-2">Login to Your Account</h3>
            <p class="text-muted">Enter your credentials to access your dashboard</p>
          </div>

          <!-- Login Form -->
          <form th:action="@{/login}" method="post" class="needs-validation" novalidate>
            <div class="mb-4">
              <label for="username" class="form-label fw-bold text-dark d-flex align-items-center">
                <i class="bi bi-person-fill me-2 text-primary"></i> Username
              </label>
              <div class="input-group">
              <span class="input-group-text bg-light border-end-0">
                <i class="bi bi-person text-muted"></i>
              </span>
                <input type="text" name="username" id="username"
                       class="form-control border-start-0 py-3"
                       placeholder="Enter your username" required>
              </div>
              <div class="invalid-feedback">
                Please enter your username.
              </div>
            </div>

            <div class="mb-4">
              <label for="password" class="form-label fw-bold text-dark d-flex align-items-center">
                <i class="bi bi-lock-fill me-2 text-primary"></i> Password
              </label>
              <div class="input-group">
              <span class="input-group-text bg-light border-end-0">
                <i class="bi bi-key text-muted"></i>
              </span>
                <input type="password" name="password" id="password"
                       class="form-control border-start-0 py-3"
                       placeholder="Enter your password" required>
                <button type="button" class="btn btn-outline-secondary border-start-0" onclick="togglePassword()">
                  <i class="bi bi-eye" id="toggleIcon"></i>
                </button>
              </div>
              <div class="invalid-feedback">
                Please enter your password.
              </div>
            </div>

            <!-- Remember Me & Forgot Password -->
            <div class="d-flex justify-content-between align-items-center mb-4">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="rememberMe" name="remember-me">
                <label class="form-check-label small text-muted" for="rememberMe">
                  Remember me
                </label>
              </div>
              <a href="#" class="small text-decoration-none text-primary fw-bold">
                Forgot password?
              </a>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary w-100 py-3 fw-bold shadow-sm mb-3"
                    style="border-radius: 10px; font-size: 1.1rem;">
              <i class="bi bi-box-arrow-in-right me-2"></i> Login
            </button>

            <!-- Demo Credentials -->
            <div class="alert alert-info small" role="alert">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Demo:</strong> Try with username: student / teacher
            </div>
          </form>

          <!-- Divider -->
          <div class="divider d-flex align-items-center my-4">
            <p class="text-center text-muted mx-3 mb-0 small">Or continue with</p>
          </div>

          <!-- Social Login (Optional) -->
          <div class="text-center mb-4">
            <button type="button" class="btn btn-outline-primary btn-sm me-2 rounded-circle" style="width: 40px; height: 40px;">
              <i class="bi bi-google"></i>
            </button>
            <button type="button" class="btn btn-outline-info btn-sm me-2 rounded-circle" style="width: 40px; height: 40px;">
              <i class="bi bi-microsoft"></i>
            </button>
            <button type="button" class="btn btn-outline-dark btn-sm rounded-circle" style="width: 40px; height: 40px;">
              <i class="bi bi-github"></i>
            </button>
          </div>

          <!-- Signup Link -->
          <div class="text-center mt-4">
            <p class="text-muted mb-0">Don't have an account?
              <a th:href="@{/signup}" class="text-primary fw-bold text-decoration-none">
                Create an account
              </a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SIGNUP FORM -->
  <div th:if="${page == 'signup'}" class="row justify-content-center align-items-center min-vh-100">
    <div class="col-md-6 col-lg-5">
      <div class="card border-0 shadow-lg overflow-hidden" style="border-radius: 20px;">
        <!-- Decorative Top Bar -->
        <div class="card-header bg-gradient-success text-white p-4 border-0" style="border-radius: 20px 20px 0 0;">
          <div class="d-flex align-items-center">
            <div class="logo-circle me-3" style="width: 50px; height: 50px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
              <i class="bi bi-mortarboard-fill fs-4"></i>
            </div>
            <div>
              <h4 class="mb-0 fw-bold">Join Our School</h4>
              <small class="opacity-75">Create your account</small>
            </div>
          </div>
        </div>

        <div class="card-body p-4">
          <!-- Animated Illustration -->
          <div class="text-center mb-4">
            <div class="signup-illustration mx-auto mb-3" style="width: 120px; height: 120px; background: linear-gradient(135deg, #00b09b 0%, #96c93d 50%); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
              <i class="bi bi-person-plus text-white" style="font-size: 3.5rem;"></i>
            </div>
            <h3 class="fw-bold text-dark mb-2">Create New Account</h3>
            <p class="text-muted">Join our school system in minutes</p>
          </div>

          <!-- Signup Form -->
          <form th:action="@{/signup}" th:object="${user}" method="post" class="needs-validation" novalidate>
            <!-- Username Field -->
            <div class="mb-4">
              <label for="signup-username" class="form-label fw-bold text-dark d-flex align-items-center">
                <i class="bi bi-person-circle me-2 text-success"></i> Username
              </label>
              <div class="input-group">
              <span class="input-group-text bg-light border-end-0">
                <i class="bi bi-at text-muted"></i>
              </span>
                <input type="text" th:field="*{username}" id="signup-username"
                       class="form-control border-start-0 py-3"
                       placeholder="Choose a username" required>
              </div>
              <div class="form-text small text-muted">
                Choose a unique username (3-20 characters)
              </div>
              <div class="invalid-feedback">
                Please choose a username.
              </div>
            </div>

            <!-- Password Field -->
            <div class="mb-4">
              <label for="signup-password" class="form-label fw-bold text-dark d-flex align-items-center">
                <i class="bi bi-shield-lock me-2 text-success"></i> Password
              </label>
              <div class="input-group">
              <span class="input-group-text bg-light border-end-0">
                <i class="bi bi-key text-muted"></i>
              </span>
                <input type="password" th:field="*{password}" id="signup-password"
                       class="form-control border-start-0 py-3"
                       placeholder="Create a strong password" required>
                <button type="button" class="btn btn-outline-secondary border-start-0" onclick="toggleSignupPassword()">
                  <i class="bi bi-eye" id="signupToggleIcon"></i>
                </button>
              </div>
              <div class="form-text small text-muted">
                Minimum 6 characters with letters and numbers
              </div>
              <div class="invalid-feedback">
                Please create a password.
              </div>
            </div>

            <!-- Role Selection -->
            <div class="mb-4">
              <label for="role" class="form-label fw-bold text-dark d-flex align-items-center">
                <i class="bi bi-person-rolodex me-2 text-success"></i> Account Type
              </label>
              <div class="input-group">
              <span class="input-group-text bg-light border-end-0">
                <i class="bi bi-people text-muted"></i>
              </span>
                <select th:field="*{role}" id="role"
                        class="form-select border-start-0 py-3" required>
                  <option value="" disabled selected>Select your role</option>
                  <option value="ROLE_STUDENT">üéì Student</option>
                  <option value="ROLE_TEACHER">üë®‚Äçüè´ Teacher</option>
                </select>
              </div>
              <div class="form-text small text-muted">
                Students can enroll in courses, Teachers can manage courses
              </div>
              <div class="invalid-feedback">
                Please select your role.
              </div>
            </div>

            <!-- Terms Agreement -->
            <div class="mb-4">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="terms" required>
                <label class="form-check-label small text-muted" for="terms">
                  I agree to the <a href="#" class="text-decoration-none text-success fw-bold">Terms of Service</a>
                  and <a href="#" class="text-decoration-none text-success fw-bold">Privacy Policy</a>
                </label>
                <div class="invalid-feedback">
                  You must agree to the terms before signing up.
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-success w-100 py-3 fw-bold shadow-sm mb-3"
                    style="border-radius: 10px; font-size: 1.1rem;">
              <i class="bi bi-person-plus me-2"></i> Create Account
            </button>

            <!-- Role Benefits -->
            <div class="row g-2 mb-4">
              <div class="col-6">
                <div class="border rounded p-3 text-center h-100">
                  <i class="bi bi-mortarboard fs-4 text-primary mb-2 d-block"></i>
                  <small class="fw-bold text-dark">Student</small>
                  <p class="small text-muted mb-0">Enroll in courses, track progress</p>
                </div>
              </div>
              <div class="col-6">
                <div class="border rounded p-3 text-center h-100">
                  <i class="bi bi-easel fs-4 text-warning mb-2 d-block"></i>
                  <small class="fw-bold text-dark">Teacher</small>
                  <p class="small text-muted mb-0">Create courses, manage students</p>
                </div>
              </div>
            </div>
          </form>

          <!-- Divider -->
          <div class="divider d-flex align-items-center my-4">
            <p class="text-center text-muted mx-3 mb-0 small">Already have an account?</p>
          </div>

          <!-- Login Link -->
          <div class="text-center">
            <a th:href="@{/login}" class="btn btn-outline-primary w-100 py-2">
              <i class="bi bi-box-arrow-in-right me-2"></i> Back to Login
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Custom CSS for Forms -->
  <style>
    /* Form Animations */
    .card {
      animation: slideUp 0.6s ease-out;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Gradient Backgrounds */
    .bg-gradient-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .bg-gradient-success {
      background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
    }

    /* Input Styling */
    .form-control:focus, .form-select:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 0.25rem rgba(102, 126, 234, 0.25);
    }

    .input-group-text {
      background-color: #f8f9fa;
      border-color: #dee2e6;
    }

    /* Button Hover Effects */
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
      border: none;
      transition: all 0.3s ease;
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 176, 155, 0.4);
    }

    /* Illustration Animation */
    .login-illustration, .signup-illustration {
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-10px);
      }
    }

    /* Divider */
    .divider:before,
    .divider:after {
      content: "";
      flex: 1;
      height: 1px;
      background: #dee2e6;
    }

    /* Card Hover Effect */
    .card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.1) !important;
    }

    /* Role Selection Icons */
    option[value="ROLE_STUDENT"] {
      color: #0d6efd;
      font-weight: bold;
    }

    option[value="ROLE_TEACHER"] {
      color: #fd7e14;
      font-weight: bold;
    }
  </style>

  <!-- Add JavaScript for Form Validation and Password Toggle -->
  <script>
    // Password toggle for login form
    function togglePassword() {
      const passwordInput = document.getElementById('password');
      const toggleIcon = document.getElementById('toggleIcon');

      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.classList.remove('bi-eye');
        toggleIcon.classList.add('bi-eye-slash');
      } else {
        passwordInput.type = 'password';
        toggleIcon.classList.remove('bi-eye-slash');
        toggleIcon.classList.add('bi-eye');
      }
    }

    // Password toggle for signup form
    function toggleSignupPassword() {
      const passwordInput = document.getElementById('signup-password');
      const toggleIcon = document.getElementById('signupToggleIcon');

      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        toggleIcon.classList.remove('bi-eye');
        toggleIcon.classList.add('bi-eye-slash');
      } else {
        passwordInput.type = 'password';
        toggleIcon.classList.remove('bi-eye-slash');
        toggleIcon.classList.add('bi-eye');
      }
    }

    // Form validation
    (function() {
      'use strict';

      // Fetch all forms with class .needs-validation
      const forms = document.querySelectorAll('.needs-validation');

      // Loop over them and prevent submission
      Array.prototype.slice.call(forms).forEach(function(form) {
        form.addEventListener('submit', function(event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    })();

    // Dynamic background for signup page
    if (window.location.pathname.includes('signup')) {
      document.body.style.background = 'linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)';
    } else if (window.location.pathname.includes('login')) {
      document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
    }
  </script>

  <!-- STUDENT DASHBOARD -->
  <div th:if="${page == 'student'}" class="container-fluid">
    <div class="row g-0">
      <!-- Sidebar - Beautiful Modern Design -->
      <div class="col-md-3 col-lg-2 p-0">
        <div class="sidebar-wrapper vh-100 d-flex flex-column" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <!-- Welcome Section -->
          <div class="welcome-section text-center text-white p-4">
            <div class="avatar-circle mx-auto mb-3" style="width: 80px; height: 80px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
              <i class="bi bi-person-fill" style="font-size: 2.5rem;"></i>
            </div>
            <h5 class="mb-1 fw-bold">Welcome back,</h5>
            <h4 class="fw-bold text-warning mb-0" th:text="${studentName}"></h4>
            <p class="small opacity-75 mb-0">Student Portal</p>
          </div>

          <!-- Navigation -->
          <div class="nav-section flex-grow-1 px-3">
            <ul class="nav flex-column gap-2">
              <li class="nav-item">
                <a class="nav-link text-white d-flex align-items-center py-3 px-4 rounded-4"
                   th:classappend="${activeSection == 'myCourses'} ? 'active-nav' : 'nav-hover'"
                   th:href="@{/student/my-courses}">
                  <div class="nav-icon me-3">
                    <i class="bi bi-bookmark-check-fill" style="font-size: 1.2rem;"></i>
                  </div>
                  <div>
                    <div class="fw-bold">My Courses</div>
                    <small class="opacity-75" th:if="${selectedCourses != null}">
                      <span th:text="${selectedCourses.size()}">0</span> courses selected
                    </small>
                  </div>
                </a>
              </li>

              <li class="nav-item">
                <a class="nav-link text-white d-flex align-items-center py-3 px-4 rounded-4"
                   th:classappend="${activeSection == 'availableCourses'} ? 'active-nav' : 'nav-hover'"
                   th:href="@{/student/available-courses}">
                  <div class="nav-icon me-3">
                    <i class="bi bi-grid-1x2-fill" style="font-size: 1.2rem;"></i>
                  </div>
                  <div>
                    <div class="fw-bold">Available Courses</div>
                    <small class="opacity-75" th:if="${availableCourses != null}">
                      <span th:text="${availableCourses.size()}">0</span> courses available
                    </small>
                  </div>
                </a>
              </li>
            </ul>

            <!-- Quick Stats -->
            <div class="stats-card mt-5 p-3 rounded-4" style="background: rgba(255,255,255,0.1); backdrop-filter: blur(10px);">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <span class="text-white-50 small">Total Credits</span>
                <span class="badge bg-warning text-dark" th:text="${#aggregates.sum(selectedCourses.![credit])}">0</span>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <span class="text-white-50 small">Courses Added</span>
                <span class="badge bg-info" th:text="${selectedCourses != null ? selectedCourses.size() : 0}">0</span>
              </div>
            </div>
          </div>

          <!-- Logout Section -->
          <div class="logout-section p-4 border-top" style="border-color: rgba(255,255,255,0.1) !important;">
            <form th:action="@{/logout}" method="post" class="w-100">
              <button type="submit" class="btn btn-outline-light w-100 d-flex align-items-center justify-content-center py-2 rounded-4">
                <i class="bi bi-box-arrow-right me-2"></i>
                <span>Logout</span>
              </button>
            </form>
            <div class="text-center mt-3">
              <small class="text-white-50">¬© School System 2024</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="col-md-9 col-lg-10 p-0">
        <div class="main-content vh-100 overflow-auto" style="background-color: #f8f9fa;">
          <!-- Top Bar -->
          <div class="top-bar p-3" style="background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h4 class="fw-bold mb-0 text-primary" th:if="${activeSection == 'myCourses'}">
                  <i class="bi bi-bookmark-check me-2"></i> My Selected Courses
                </h4>
                <h4 class="fw-bold mb-0 text-success" th:if="${activeSection == 'availableCourses'}">
                  <i class="bi bi-grid-1x2 me-2"></i> Available Courses
                </h4>
              </div>
              <div class="d-flex align-items-center">
                <div class="me-3">
                  <span class="text-muted small">Today is</span>
                  <div class="fw-bold" id="current-date"></div>
                </div>
                <div class="dropdown">
                  <button class="btn btn-outline-primary btn-sm dropdown-toggle d-flex align-items-center" type="button" data-bs-toggle="dropdown">
                    <i class="bi bi-person-circle me-2"></i>
                    <span th:text="${studentName}"></span>
                  </button>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" th:href="@{/student/my-courses}"><i class="bi bi-bookmark-check me-2"></i>My Courses</a></li>
                    <li><a class="dropdown-item" th:href="@{/student/available-courses}"><i class="bi bi-grid-1x2 me-2"></i>Available Courses</a></li>
                    <li><hr class="dropdown-divider"></li>
                    <li>
                      <form th:action="@{/logout}" method="post">
                        <button type="submit" class="dropdown-item text-danger">
                          <i class="bi bi-box-arrow-right me-2"></i>Logout
                        </button>
                      </form>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>

          <!-- Content Area -->
          <div class="content-area p-4">
            <!-- My Courses Section -->
            <div th:if="${activeSection == 'myCourses'}">
              <div class="row mb-4">
                <div class="col-md-8">
                  <div class="alert alert-primary d-flex align-items-center" role="alert">
                    <i class="bi bi-info-circle-fill fs-5 me-3"></i>
                    <div>
                      These are the courses you've selected. You can remove them anytime.
                      <span th:if="${selectedCourses != null and selectedCourses.size() > 0}" class="fw-bold">
                      Total credits: <span th:text="${#aggregates.sum(selectedCourses.![credit])}">0</span>
                    </span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 text-end">
                  <a th:href="@{/student/available-courses}" class="btn btn-success">
                    <i class="bi bi-plus-circle me-2"></i> Add More Courses
                  </a>
                </div>
              </div>

              <div th:if="${selectedCourses != null and !selectedCourses.isEmpty()}">
                <div class="row g-4">
                  <div class="col-lg-4 col-md-6" th:each="course : ${selectedCourses}">
                    <div class="card course-card h-100 border-0 shadow-sm hover-shadow">
                      <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                          <div>
                            <span class="badge bg-primary mb-2" th:text="${course.courseId}"></span>
                            <h5 class="card-title fw-bold mb-1" th:text="${course.courseName}"></h5>
                          </div>
                          <span class="badge bg-warning text-dark fs-6" th:text="'CR ' + ${course.credit}"></span>
                        </div>
                        <div class="course-actions mt-4">
                          <form th:action="@{/student/remove-course}" method="post" class="w-100">
                            <input type="hidden" name="courseId" th:value="${course.id}">
                            <button type="submit" class="btn btn-outline-danger w-100">
                              <i class="bi bi-trash me-2"></i> Remove Course
                            </button>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div th:if="${selectedCourses == null or selectedCourses.isEmpty()}" class="text-center py-5">
                <div class="empty-state">
                  <div class="empty-icon mb-4">
                    <i class="bi bi-journal-x" style="font-size: 4rem; color: #6c757d;"></i>
                  </div>
                  <h4 class="text-muted mb-3">No courses selected yet</h4>
                  <p class="text-muted mb-4">You haven't added any courses to your list yet.</p>
                  <a th:href="@{/student/available-courses}" class="btn btn-primary btn-lg">
                    <i class="bi bi-plus-circle me-2"></i> Browse Available Courses
                  </a>
                </div>
              </div>
            </div>

            <!-- Available Courses Section -->
            <div th:if="${activeSection == 'availableCourses'}">
              <div class="row mb-4">
                <div class="col-md-8">
                  <div class="alert alert-success d-flex align-items-center" role="alert">
                    <i class="bi bi-lightbulb-fill fs-5 me-3"></i>
                    <div>
                      Browse all available courses. Click "Add Course" to select courses for your semester.
                      <span th:if="${selectedCourses != null}" class="fw-bold ms-2">
                      You've selected <span th:text="${selectedCourses.size()}">0</span> courses
                    </span>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 text-end">
                  <a th:href="@{/student/my-courses}" class="btn btn-primary">
                    <i class="bi bi-eye me-2"></i> View My Courses (<span th:text="${selectedCourses != null ? selectedCourses.size() : 0}">0</span>)
                  </a>
                </div>
              </div>

              <div th:if="${availableCourses != null and !availableCourses.isEmpty()}">
                <div class="row g-4">
                  <div class="col-lg-4 col-md-6" th:each="course : ${availableCourses}">
                    <div class="card course-card h-100 border-0 shadow-sm hover-shadow">
                      <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                          <div>
                            <span class="badge bg-primary mb-2" th:text="${course.courseId}"></span>
                            <h5 class="card-title fw-bold mb-1" th:text="${course.courseName}"></h5>
                          </div>
                          <span class="badge bg-warning text-dark fs-6" th:text="'CR ' + ${course.credit}"></span>
                        </div>

                        <div class="course-status mb-3">
                          <th:block th:if="${selectedCourses != null}">
                            <div th:if="${selectedCourses.?[id == course.id].size() > 0}"
                                 class="alert alert-success py-2 px-3 small mb-0">
                              <i class="bi bi-check-circle-fill me-2"></i>
                              Already in your courses
                            </div>
                            <div th:if="${selectedCourses.?[id == course.id].size() == 0}"
                                 class="alert alert-light py-2 px-3 small mb-0">
                              <i class="bi bi-clock me-2"></i>
                              Available for enrollment
                            </div>
                          </th:block>
                        </div>

                        <div class="course-actions mt-4">
                          <form th:action="@{/student/add-course}" method="post" class="w-100">
                            <input type="hidden" name="courseId" th:value="${course.id}">
                            <button type="submit" class="btn btn-success w-100"
                                    th:disabled="${selectedCourses != null and selectedCourses.?[id == course.id].size() > 0}"
                                    th:classappend="${selectedCourses != null and selectedCourses.?[id == course.id].size() > 0} ? 'btn-secondary' : ''">
                              <i class="bi bi-plus-circle me-2"></i>
                              <span th:if="${selectedCourses != null and selectedCourses.?[id == course.id].size() > 0}">Already Added</span>
                              <span th:if="${selectedCourses == null or selectedCourses.?[id == course.id].size() == 0}">Add Course</span>
                            </button>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div th:if="${availableCourses == null or availableCourses.isEmpty()}" class="text-center py-5">
                <div class="empty-state">
                  <div class="empty-icon mb-4">
                    <i class="bi bi-journal-x" style="font-size: 4rem; color: #6c757d;"></i>
                  </div>
                  <h4 class="text-muted mb-3">No courses available</h4>
                  <p class="text-muted mb-4">Please ask your teacher to add courses to the system.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add this CSS for custom styling -->
  <style>
    /* Sidebar Styles */
    .sidebar-wrapper {
      box-shadow: 3px 0 15px rgba(0,0,0,0.1);
    }

    .active-nav {
      background: rgba(255,255,255,0.15) !important;
      backdrop-filter: blur(10px);
      border-left: 4px solid #ffc107;
    }

    .nav-hover:hover {
      background: rgba(255,255,255,0.1);
      transform: translateX(5px);
      transition: all 0.3s ease;
    }

    /* Course Cards */
    .course-card {
      border-radius: 12px !important;
      transition: all 0.3s ease;
      border: 1px solid rgba(0,0,0,0.08);
    }

    .course-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
    }

    .hover-shadow:hover {
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    /* Empty State */
    .empty-state {
      max-width: 500px;
      margin: 0 auto;
      padding: 3rem;
      background: white;
      border-radius: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.05);
    }

    /* Badge Styles */
    .badge {
      padding: 0.5em 0.8em;
      border-radius: 20px;
    }

    /* Scrollbar Styling */
    .main-content::-webkit-scrollbar {
      width: 8px;
    }

    .main-content::-webkit-scrollbar-track {
      background: #f1f1f1;
    }

    .main-content::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 4px;
    }

    .main-content::-webkit-scrollbar-thumb:hover {
      background: #a1a1a1;
    }
  </style>

  <!-- Add JavaScript for current date -->
  <script>
    // Display current date
    function updateCurrentDate() {
      const now = new Date();
      const options = {
        weekday: 'long',
        year: 'numeric',
        month: 'long',
        day: 'numeric'
      };
      document.getElementById('current-date').textContent =
              now.toLocaleDateString('en-US', options);
    }

    // Update date on page load
    document.addEventListener('DOMContentLoaded', updateCurrentDate);
  </script>
  <!-- TEACHER DASHBOARD -->
  <div th:if="${page == 'teacher'}" class="container-fluid">
    <div class="row g-0">
      <!-- Sidebar -->
      <div class="col-md-3 col-lg-2 p-0">
        <div class="sidebar-wrapper vh-100 d-flex flex-column" style="background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);">
          <!-- Welcome Section -->
          <div class="welcome-section text-center text-white p-4">
            <div class="avatar-circle mx-auto mb-3" style="width: 70px; height: 70px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
              <i class="bi bi-person-workspace fs-3"></i>
            </div>
            <h5 class="mb-1 fw-bold">Welcome, Teacher</h5>
            <small class="opacity-75">Management Dashboard</small>
          </div>

          <!-- Navigation -->
          <div class="nav-section flex-grow-1 px-3">
            <ul class="nav flex-column gap-2">
              <li class="nav-item">
                <a href="javascript:void(0)" onclick="showSection('dashboard')"
                   class="nav-link text-white d-flex align-items-center py-3 px-4 rounded-4 active-nav">
                  <div class="nav-icon me-3">
                    <i class="bi bi-house-door-fill"></i>
                  </div>
                  <div class="fw-bold">Dashboard</div>
                </a>
              </li>
              <li class="nav-item">
                <a href="javascript:void(0)" onclick="showSection('students')"
                   class="nav-link text-white d-flex align-items-center py-3 px-4 rounded-4 nav-hover">
                  <div class="nav-icon me-3">
                    <i class="bi bi-people-fill"></i>
                  </div>
                  <div class="fw-bold">Students</div>
                  <span class="badge bg-info ms-auto" th:text="${students.size()}">0</span>
                </a>
              </li>
              <li class="nav-item">
                <a href="javascript:void(0)" onclick="showSection('courses')"
                   class="nav-link text-white d-flex align-items-center py-3 px-4 rounded-4 nav-hover">
                  <div class="nav-icon me-3">
                    <i class="bi bi-journal-bookmark-fill"></i>
                  </div>
                  <div class="fw-bold">Courses</div>
                  <span class="badge bg-success ms-auto" th:text="${courses.size()}">0</span>
                </a>
              </li>
              <li class="nav-item">
                <a href="javascript:void(0)" onclick="showSection('addCourse')"
                   class="nav-link text-white d-flex align-items-center py-3 px-4 rounded-4 nav-hover">
                  <div class="nav-icon me-3">
                    <i class="bi bi-plus-circle-fill"></i>
                  </div>
                  <div class="fw-bold">Add Course</div>
                </a>
              </li>
            </ul>
          </div>

          <!-- Logout -->
          <div class="logout-section p-4 border-top" style="border-color: rgba(255,255,255,0.1) !important;">
            <form th:action="@{/logout}" method="post" class="w-100">
              <button type="submit" class="btn btn-outline-light w-100 py-2 rounded-4">
                <i class="bi bi-box-arrow-right me-2"></i> Logout
              </button>
            </form>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="col-md-9 col-lg-10 p-4" style="background-color: #f8f9fa;">
        <!-- Dashboard Section (Default) -->
        <div id="dashboardSection" class="dashboard-content">
          <!-- Welcome Message -->
          <div class="welcome-card mb-4">
            <div class="card border-0 shadow-sm" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
              <div class="card-body text-white p-4">
                <div class="d-flex align-items-center">
                  <div class="me-3">
                    <i class="bi bi-mortarboard-fill fs-1"></i>
                  </div>
                  <div>
                    <h3 class="fw-bold mb-1">Welcome to Teacher Dashboard</h3>
                    <p class="mb-0 opacity-75">Manage students, courses, and academic activities</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Stats Cards -->
          <div class="row g-4 mb-4">
            <div class="col-md-4">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                  <div class="d-flex align-items-center">
                    <div class="icon-circle me-3" style="width: 50px; height: 50px; background: #e3f2fd; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                      <i class="bi bi-people-fill fs-4 text-primary"></i>
                    </div>
                    <div>
                      <h2 class="fw-bold mb-0" th:text="${students.size()}">0</h2>
                      <p class="text-muted mb-0">Total Students</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                  <div class="d-flex align-items-center">
                    <div class="icon-circle me-3" style="width: 50px; height: 50px; background: #e8f5e9; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                      <i class="bi bi-journal-bookmark-fill fs-4 text-success"></i>
                    </div>
                    <div>
                      <h2 class="fw-bold mb-0" th:text="${courses.size()}">0</h2>
                      <p class="text-muted mb-0">Total Courses</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                  <div class="d-flex align-items-center">
                    <div class="icon-circle me-3" style="width: 50px; height: 50px; background: #fff3e0; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                      <i class="bi bi-plus-circle-fill fs-4 text-warning"></i>
                    </div>
                    <div>
                      <h2 class="fw-bold mb-0">Quick Actions</h2>
                      <p class="text-muted mb-0">Manage Content</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Quick Links -->
          <div class="row g-4">
            <div class="col-md-6">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0 py-3">
                  <h5 class="fw-bold mb-0 d-flex align-items-center">
                    <i class="bi bi-people-fill text-primary me-2"></i> Manage Students
                  </h5>
                </div>
                <div class="card-body">
                  <p class="text-muted mb-3">View and manage all registered students in the system.</p>
                  <button onclick="showSection('students')" class="btn btn-primary w-100">
                    <i class="bi bi-arrow-right me-2"></i> Go to Students
                  </button>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-0 py-3">
                  <h5 class="fw-bold mb-0 d-flex align-items-center">
                    <i class="bi bi-journal-bookmark-fill text-success me-2"></i> Manage Courses
                  </h5>
                </div>
                <div class="card-body">
                  <p class="text-muted mb-3">View existing courses or add new courses to the system.</p>
                  <div class="d-grid gap-2">
                    <button onclick="showSection('courses')" class="btn btn-success">
                      <i class="bi bi-journals me-2"></i> View Courses
                    </button>
                    <button onclick="showSection('addCourse')" class="btn btn-warning">
                      <i class="bi bi-plus-circle me-2"></i> Add New Course
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Students Section (Hidden by default) -->
        <div id="studentsSection" class="section-content" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="fw-bold d-flex align-items-center">
              <i class="bi bi-people-fill text-primary me-2"></i> Students Management
            </h4>
            <button onclick="showSection('dashboard')" class="btn btn-outline-secondary">
              <i class="bi bi-arrow-left me-2"></i> Back to Dashboard
            </button>
          </div>

          <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-0 py-3">
              <h5 class="fw-bold mb-0">All Students</h5>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-hover">
                  <thead class="table-light">
                  <tr>
                    <th>Student ID</th>
                    <th>Username</th>
                    <th>Actions</th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr th:each="s, stat : ${students}">
                    <td th:text="${stat.index + 1}"></td>
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="avatar-sm me-3" style="width: 36px; height: 36px; background: #e3f2fd; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                          <i class="bi bi-person text-primary"></i>
                        </div>
                        <span th:text="${s.username}"></span>
                      </div>
                    </td>
                    <td>
                      <form th:action="@{/teacher/delete/{id}(id=${s.id})}" method="post" class="d-inline">
                        <button type="submit" class="btn btn-sm btn-danger"
                                onclick="return confirm('Are you sure you want to delete this student?');">
                          <i class="bi bi-trash"></i> Delete
                        </button>
                      </form>
                    </td>
                  </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Courses Section (Hidden by default) -->
        <div id="coursesSection" class="section-content" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="fw-bold d-flex align-items-center">
              <i class="bi bi-journal-bookmark-fill text-success me-2"></i> Course Catalog
            </h4>
            <div>
              <button onclick="showSection('addCourse')" class="btn btn-warning me-2">
                <i class="bi bi-plus-circle me-2"></i> Add Course
              </button>
              <button onclick="showSection('dashboard')" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i> Back
              </button>
            </div>
          </div>

          <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-0 py-3">
              <h5 class="fw-bold mb-0">All Courses</h5>
            </div>
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-6 col-lg-4" th:each="c : ${courses}">
                  <div class="course-card p-3 border rounded">
                    <div class="d-flex align-items-start mb-2">
                      <div class="course-icon me-3" style="width: 50px; height: 50px; background: #e8f5e9; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="bi bi-book-half text-success fs-5"></i>
                      </div>
                      <div>
                        <h6 class="fw-bold mb-1" th:text="${c.courseName}"></h6>
                        <small class="text-muted d-block" th:text="'ID: ' + ${c.courseId}"></small>
                      </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                      <span class="badge bg-info" th:text="'Credit: ' + ${c.credit}"></span>
                      <small class="text-muted">Course</small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Add Course Section (Hidden by default) -->
        <div id="addCourseSection" class="section-content" style="display: none;">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 class="fw-bold d-flex align-items-center">
              <i class="bi bi-plus-circle-fill text-warning me-2"></i> Create New Course
            </h4>
            <button onclick="showSection('courses')" class="btn btn-outline-secondary">
              <i class="bi bi-arrow-left me-2"></i> View Courses
            </button>
          </div>

          <div class="row">
            <div class="col-lg-8">
              <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                  <form th:action="@{/teacher/add-course}" th:object="${newCourse}" method="post">
                    <div class="mb-4">
                      <label class="form-label fw-bold">Course ID</label>
                      <input type="text" th:field="*{courseId}" class="form-control form-control-lg"
                             placeholder="Enter course code (e.g., CS101)" required>
                      <div class="form-text">Unique identifier for the course</div>
                    </div>

                    <div class="mb-4">
                      <label class="form-label fw-bold">Course Name</label>
                      <input type="text" th:field="*{courseName}" class="form-control form-control-lg"
                             placeholder="Enter course title" required>
                      <div class="form-text">Full name of the course</div>
                    </div>

                    <div class="mb-4">
                      <label class="form-label fw-bold">Credit Hours</label>
                      <input type="number" th:field="*{credit}" class="form-control form-control-lg"
                             min="0" max="10" placeholder="Enter credit hours" required>
                      <div class="form-text">Number of credit hours (0-10)</div>
                    </div>

                    <div class="d-grid">
                      <button type="submit" class="btn btn-success btn-lg py-3">
                        <i class="bi bi-plus-circle me-2"></i> Create Course
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>

            <div class="col-lg-4">
              <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-0">
                  <h6 class="fw-bold mb-0">Course Guidelines</h6>
                </div>
                <div class="card-body">
                  <ul class="list-unstyled">
                    <li class="mb-3">
                      <i class="bi bi-info-circle text-primary me-2"></i>
                      <small>Course ID should be unique (e.g., CS101, MATH201)</small>
                    </li>
                    <li class="mb-3">
                      <i class="bi bi-info-circle text-primary me-2"></i>
                      <small>Course name should be descriptive and clear</small>
                    </li>
                    <li class="mb-3">
                      <i class="bi bi-info-circle text-primary me-2"></i>
                      <small>Credit hours determine course weight (typically 1-4)</small>
                    </li>
                    <li>
                      <i class="bi bi-info-circle text-primary me-2"></i>
                      <small>Students can enroll in courses after creation</small>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <style>
    /* Sidebar Styles */
    .sidebar-wrapper {
      box-shadow: 3px 0 15px rgba(0,0,0,0.1);
    }

    .active-nav {
      background: rgba(255,255,255,0.15) !important;
      backdrop-filter: blur(10px);
      border-left: 4px solid #ffc107;
    }

    .nav-hover:hover {
      background: rgba(255,255,255,0.1);
      transform: translateX(5px);
      transition: all 0.3s ease;
    }

    /* Course Cards */
    .course-card {
      transition: all 0.3s ease;
      border: 1px solid rgba(0,0,0,0.08);
    }

    .course-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border-color: #667eea;
    }

    /* Icon Circles */
    .icon-circle {
      transition: all 0.3s ease;
    }

    .icon-circle:hover {
      transform: scale(1.1);
    }

    /* Section Animation */
    .section-content {
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Table Hover */
    .table-hover tbody tr:hover {
      background-color: rgba(102, 126, 234, 0.05);
    }
  </style>

  <script>
    // Function to show different sections
    function showSection(section) {
      // Hide all sections
      document.querySelectorAll('.section-content, .dashboard-content').forEach(el => {
        el.style.display = 'none';
      });

      // Show selected section
      if (section === 'dashboard') {
        document.getElementById('dashboardSection').style.display = 'block';
      } else if (section === 'students') {
        document.getElementById('studentsSection').style.display = 'block';
      } else if (section === 'courses') {
        document.getElementById('coursesSection').style.display = 'block';
      } else if (section === 'addCourse') {
        document.getElementById('addCourseSection').style.display = 'block';
      }

      // Update active nav
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active-nav');
      });

      // Find and activate clicked nav item
      const navItems = document.querySelectorAll('.nav-link');
      navItems.forEach(item => {
        if (item.textContent.includes('Dashboard') && section === 'dashboard') {
          item.classList.add('active-nav');
        } else if (item.textContent.includes('Students') && section === 'students') {
          item.classList.add('active-nav');
        } else if (item.textContent.includes('Courses') && section === 'courses') {
          item.classList.add('active-nav');
        } else if (item.textContent.includes('Add Course') && section === 'addCourse') {
          item.classList.add('active-nav');
        }
      });
    }

    // Initialize dashboard as active
    document.addEventListener('DOMContentLoaded', function() {
      showSection('dashboard');
    });
  </script>
<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
